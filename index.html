<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>RightClick - Job Acknowledgement</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<style>
body{font-family:Roboto;background:#f5f8fb;margin:0}
header{background:#003366;color:white;padding:15px;text-align:center}
main{max-width:600px;margin:30px auto;background:white;padding:25px;border-radius:12px;box-shadow:0 4px 10px rgba(0,0,0,.1)}
label{display:block;margin-top:12px}
input,select,textarea{width:100%;padding:10px;border-radius:6px;border:1px solid #ccc}
button{margin-top:20px;padding:12px;background:#003366;color:white;border:none;border-radius:8px;font-size:16px;cursor:pointer}
</style>
</head>
<body>

<header>
<h2>RightClick Computer Sales & Service Center</h2>
<p>Customer Acknowledgement</p>
</header>

<main>
<form id="jobForm">
<label>Job Date</label>
<input type="text" id="jobDate" required>

<label>Customer Name</label>
<input type="text" id="customerName" required>

<label>Mobile Number</label>
<input type="tel" id="mobile" required>

<label>Item</label>
<select id="item">
<option>Laptop</option>
<option>Desktop / CPU</option>
<option>Printer</option>
<option>Monitor</option>
<option>UPS</option>
<option>Other</option>
</select>

<label>Problem</label>
<textarea id="problem"></textarea>

<button type="submit">Create Job</button>
</form>
</main>

<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

const firebaseConfig = {
 apiKey: "AIzaSyB8uRXxvOyZeCUzPEt-pUytXj_R8N_JLww",
 authDomain: "rightclick-service-center.firebaseapp.com",
 projectId: "rightclick-service-center",
 storageBucket: "rightclick-service-center.firebasestorage.app",
 messagingSenderId: "558210394752",
 appId: "1:558210394752:web:a3f8663d7c6dc8cc88d465"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

flatpickr("#jobDate",{dateFormat:"d-m-Y",defaultDate:"today"});

document.getElementById("jobForm").addEventListener("submit",async(e)=>{
 e.preventDefault();

 const dateObj = new Date();
 const dateStr = dateObj.toISOString().slice(0,10).replace(/-/g,"");
 const rand = Math.floor(1000+Math.random()*9000);
 const jobId = `RC-${dateStr}-${rand}`;
 const timestamp = dateObj.toLocaleString("en-IN");

 const data = {
  jobId,
  customerName:customerName.value,
  mobile:mobile.value,
  item:item.value,
  problem:problem.value,
  status:"Received",
  date:jobDate.value,
  timestamp,
  createdAt:serverTimestamp()
 };

 await addDoc(collection(db,"jobs"),data);

 let number = mobile.value.trim();
 if(!number.startsWith("91")) number="91"+number;

 const msg = encodeURIComponent(
`RightClick Computer Sales & Service Center
Your device has been "received" successfully.
Job ID: ${jobId}
Timestamp: ${timestamp}
Thank you.`
 );

 window.open(`https://wa.me/${number}?text=${msg}`,"_blank");
 alert("Job Created : "+jobId);
 document.getElementById("jobForm").reset();
});
</script>
</body>
</html>
